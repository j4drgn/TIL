# 2025-08-13 (수)

## 목차
1. [SQL DCL(Data Control Language) 학습](#sql-dcldata-control-language-학습)
2. [Java JDBC 학습](#java-jdbc-학습)

## SQL DCL(Data Control Language) 학습

오늘은 SQL의 DCL(Data Control Language)에 대해 학습했습니다.

### 1. COMMIT과 ROLLBACK

- **COMMIT**
  - 트랜잭션 처리가 정상적으로 종료되는 상황에서 사용
  - 트랜잭션이 수행한 변경 내용을 데이터베이스에 반영하는 연산
  - COMMIT 이후에는 시스템 오류가 발생해도 변경사항이 취소되지 않음

- **ROLLBACK**
  - 트랜잭션 처리가 비정상적으로 종료된 경우 사용
  - 데이터베이스의 일관성이 깨졌을 때 트랜잭션이 진행한 변경작업을 취소하는 연산
  - 이전 상태로 되돌림
  - ROLLBACK되는 범위는 이전 COMMIT 이후부터 현재까지의 작업

- **주요 특징**
  - COMMIT 이전에 진행한 작업들은 ROLLBACK으로 취소 가능
  - COMMIT 이후에는 ROLLBACK으로 취소 불가능
  - 세션 종료(접속 해제) 시 COMMIT 여부를 물어볼 수 있음

### 2. 사용자 권한 관리

- **권한의 종류**
  - 시스템 권한: DBA 계정에 부여되는 권한 (사용자 생성/삭제, 모든 CREATE 권한 등)
  - 객체 권한: 특정 객체를 조작할 수 있는 권한 (DML 관련 권한)

- **ROLE(롤)**
  - 여러 개의 권한을 묶어놓은 것
  - 사용자에게 효율적으로 권한을 부여하기 위해 사용
  - 주요 롤:
    - CONNECT: ALTER SESSION, CREATE와 관련된 롤
    - RESOURCE: 사용자 객체 생성 및 접근 권한에 해당되는 롤
    - DBA: 슈퍼관리자 권한 모두 부여되는 롤

### 3. 사용자 계정 관리 (SYSTEM 계정 기준)

- **계정 생성**
  ```sql
  CREATE USER 계정명 IDENTIFIED BY "비밀번호"
      DEFAULT TABLESPACE USERS
      TEMPORARY TABLESPACE TEMP;
  ```

- **권한 부여**
  ```sql
  GRANT CONNECT, RESOURCE TO 계정명;
  ```

- **테이블스페이스 할당량 지정**
  ```sql
  ALTER USER 계정명 QUOTA UNLIMITED ON USERS; -- 무제한 활용
  ALTER USER 계정명 QUOTA 50M ON USERS; -- 50MB로 제한
  ```

- **비밀번호 변경**
  ```sql
  ALTER USER 계정명 IDENTIFIED BY 새비밀번호;
  ```

- **권한 회수**
  ```sql
  REVOKE CONNECT, RESOURCE FROM 계정명;
  ```

- **계정 삭제**
  ```sql
  DROP USER 계정명;
  DROP USER 계정명 CASCADE; -- 객체가 있는 경우
  ```

### 4. 객체 권한 관리

- **권한 부여 (소유주 계정에서)**
  ```sql
  GRANT SELECT ON 테이블명 TO 계정명;
  GRANT INSERT ON 테이블명 TO 계정명;
  GRANT UPDATE ON 테이블명 TO 계정명;
  GRANT DELETE ON 테이블명 TO 계정명;
  ```

- **권한 회수 (소유주 계정에서)**
  ```sql
  REVOKE SELECT ON 테이블명 FROM 계정명;
  ```

- **다른 계정의 객체 접근 (권한 부여 후)**
  ```sql
  SELECT * FROM 소유주계정.테이블명;
  ```

### 5. 정보 조회

- **계정 정보 조회**
  ```sql
  SELECT * FROM DBA_USERS; -- DBA 권한으로만 조회 가능
  SELECT * FROM ALL_USERS; -- DBA 권한보다 낮은 권한으로 조회 가능
  SELECT * FROM USER_USERS; -- 현재 계정에 대한 정보 조회
  ```

- **할당량 확인**
  ```sql
  SELECT * FROM USER_TS_QUOTAS; -- 할당량 MAX_BYTES 값이 -1이면 무제한
  ```

- **객체 정보 조회**
  ```sql
  SELECT * FROM DBA_TABLES; -- DBA 권한으로 확인 가능
  SELECT * FROM ALL_TABLES; -- 부여된 권한으로 조회할 수 있는 객체 확인
  SELECT * FROM USER_TABLES; -- 자신이 생성한 모든 객체에 대한 정보
  SELECT * FROM TAB; -- 현재 계정 DB 테이블 목록
  ```

- **권한 정보 조회**
  ```sql
  SELECT * FROM USER_ROLE_PRIVS; -- 현재 계정에 부여된 권한 조회
  SELECT * FROM DBA_ROLE_PRIVS WHERE GRANTEE = '계정명'; -- 특정 계정의 권한 조회
  SELECT * FROM DBA_SYS_PRIVS WHERE GRANTEE = '롤이름'; -- 롤에 부여된 권한 조회
  ```

## Java JDBC 학습

오늘은 Java에서 데이터베이스에 접근하는 JDBC(Java Database Connectivity)에 대해 학습했습니다.

### 1. JDBC 개요

- JDBC는 자바 프로그램이 데이터베이스에 접근하여 데이터를 조회, 삽입, 수정, 삭제할 수 있도록 하는 자바 API입니다.
- 다양한 데이터베이스 시스템에 대해 일관된 인터페이스를 제공합니다.

### 2. JDBC 사용 과정

1. **JDBC 드라이버 로드**
   ```java
   Class.forName("oracle.jdbc.driver.OracleDriver");
   ```

2. **데이터베이스 연결**
   ```java
   String url = "jdbc:oracle:thin:@localhost:1521:xe";
   String user = "사용자명";
   String pwd = "비밀번호";
   Connection conn = DriverManager.getConnection(url, user, pwd);
   ```

3. **SQL 문 실행을 위한 Statement 객체 생성**
   ```java
   Statement stmt = conn.createStatement();
   ```

4. **SQL 문 실행**
   ```java
   // 조회(SELECT) 문 실행
   ResultSet rs = stmt.executeQuery("SELECT * FROM 테이블명");
   
   // 수정(INSERT, UPDATE, DELETE) 문 실행
   int result = stmt.executeUpdate("INSERT INTO 테이블명 VALUES(...)");
   ```

5. **결과 처리**
   ```java
   while(rs.next()) {
       String column1 = rs.getString("컬럼명");
       int column2 = rs.getInt("컬럼명");
       // 데이터 처리
   }
   ```

6. **자원 해제**
   ```java
   rs.close();
   stmt.close();
   conn.close();
   ```

### 3. 주요 클래스 및 인터페이스

- **Connection**: 데이터베이스 연결을 나타내는 인터페이스
- **DriverManager**: 데이터베이스 드라이버를 관리하고 데이터베이스 연결을 생성하는 클래스
- **Statement**: SQL 문을 실행하기 위한 인터페이스
- **ResultSet**: SQL 쿼리 실행 결과를 저장하는 인터페이스

### 4. 학습한 예제 코드

1. **기본 데이터베이스 연결 테스트**
   - 데이터베이스 연결 확인 기본 예제

2. **데이터베이스 연결 클래스 분리**
   - 데이터베이스 연결 기능을 별도 클래스로 분리하여 재사용성 향상

3. **데이터 조회 기능 구현**
   - Statement 객체를 사용하여 도서 정보를 조회하는 예제
   - ResultSet을 통한 결과 처리 및 출력

4. **상품 정보 조회 예제**
   - 코드 문서화(JavaDoc) 적용
   - 예외 처리 및 자원 해제 코드 개선

### 5. 주의사항

- 데이터베이스 연결 후에는 반드시 자원을 해제해야 합니다.
- SQL 인젝션 공격을 방지하기 위해 PreparedStatement 사용을 권장합니다.
- 예외 처리를 통해 데이터베이스 연결 및 쿼리 실행 중 발생할 수 있는 오류에 대응해야 합니다.