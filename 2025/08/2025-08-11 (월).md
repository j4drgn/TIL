# 2025-08-11 (월)

## SQL 학습 내용

### 1. SELECT 문 심화 학습

- GROUP BY와 HAVING 절 활용
  - GROUP BY: 특정 열의 값을 기준으로 동일한 값의 데이터들끼리 그룹을 구성
  - HAVING: GROUP BY 절에 의해 구성된 그룹들에 대해 조건 적용
  - 각 출판사별 도서가격이 25,000원 이상인 도서가 2권 이상인 출판사 조회 예제 학습

```sql
SELECT pubNo, count(*) as 도서합계
FROM book
WHERE bookPrice >= 25000
GROUP BY pubNo
HAVING count(*) >= 2;
```

### 2. SELECT를 통한 테이블 데이터 복사

- CREATE TABLE ... AS SELECT 구문 학습
- 테이블 복사 시 제약조건은 복사되지 않음 (기본키, 외래키 등은 별도 추가 필요)

```sql
-- 테이블 복사 (제약조건은 복사되지 않음)
CREATE TABLE NEWBOOK AS
SELECT * FROM BOOK WHERE BOOKDATE >= '2019-01-01';

-- 제약조건 추가
ALTER TABLE NEWBOOK
    ADD CONSTRAINT PK_NEWBOOK_BOOKNO
    PRIMARY KEY(BOOKNO);
```

- 빈 테이블에 다른 테이블의 데이터 삽입 방법

```sql
-- 빈 테이블에 데이터 저장
INSERT INTO NEWBOOK SELECT * FROM BOOK;
```

### 3. 조인(JOIN) 학습

- 여러 테이블을 결합하여 조건에 맞는 행 검색하는 방법
- 내부 조인(INNER JOIN)과 외부 조인(OUTER JOIN) 학습
  - INNER JOIN: 두 테이블에 공통되는 열이 있을 때 사용
  - OUTER JOIN: 두 테이블에 공통되는 열이 없을 때도 결과 표현 가능 (LEFT, RIGHT, FULL)

```sql
-- INNER JOIN 예시
SELECT C.clientName, B.bookName
FROM bookSale BS
    INNER JOIN client C ON C.clientNo = BS.clientNo
    INNER JOIN book B ON B.bookNo = BS.bookNo;

-- LEFT OUTER JOIN 예시 (주문하지 않은 고객도 포함)
SELECT *
FROM CLIENT C
    LEFT OUTER JOIN BOOKSALE BS
    ON C.CLIENTNO = BS.CLIENTNO
ORDER BY C.CLIENTNO;
```

- 조인 결과를 활용한 가공 필드 생성 방법

```sql
-- 주문액 계산 예시
SELECT BS.bsDate, C.clientName, B.bookName, B.bookPrice, BS.bsQty,
       BS.bsQty * B.bookPrice AS "주문액"
FROM bookSale BS
    INNER JOIN client C ON C.clientNo = BS.clientNo
    INNER JOIN book B ON B.bookNo = BS.bookNo
ORDER BY "주문액" DESC;
```

### 4. 서브쿼리(SubQuery) 학습

- 하나의 SQL문 안에 다른 SQL문이 중첩되는 구조
- 서브쿼리 먼저 실행 후 메인쿼리 실행
- 단일행 서브쿼리와 다중행 서브쿼리 구분

```sql
-- 단일행 서브쿼리 (비교 연산자 사용)
SELECT BOOKNAME, BOOKPRICE
FROM BOOK
WHERE BOOKPRICE = (
    SELECT MAX(BOOKPRICE)
    FROM BOOK
);

-- 다중행 서브쿼리 (IN 연산자 사용)
SELECT CLIENTNAME, CLIENTADDRESS
FROM CLIENT
WHERE CLIENTNO IN (
    SELECT CLIENTNO
    FROM BOOKSALE
);
```

- 조인과 서브쿼리의 차이점
  - 조인: 여러 데이터를 모두 합쳐서 연산 (카티전 곱 + 조건)
  - 서브쿼리: 필요한 데이터만 찾아서 제공 (경우에 따라 성능 차이 발생)
